cmake_minimum_required(VERSION 3.7)
project(nginx)

set(CMAKE_CXX_STANDARD 11)
set(INC_DIR /usr/local/include)
set(LINK_DIR /usr/local/lib)

aux_source_directory(./src/core CORE_SOURCE )
aux_source_directory(./src/event EVENT_SOURCE )
set(MODULES_SOURCE ./src/event/modules/ngx_epoll_module.c)
aux_source_directory(./src/http HTTP_SOURCE )
aux_source_directory(./src/http/modules HTTP_MODULES_SOURCE )
aux_source_directory(./src/os/unix OS_SOURCE )
aux_source_directory(./objs/ OS_SOURCE )


list(REMOVE_ITEM EVENT_SOURCE ./src/event/ngx_event_openssl.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_aio_read.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_aio_write.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_darwin_init.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_darwin_sendfile_chain.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_file_aio_read.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_freebsd_init.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_freebsd_rfork_thread.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_freebsd_sendfile_chain.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_linux_aio_read.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_pthread_thread.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_solaris_init.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_solaris_sendfilev_chain.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_aio_read_chain.c)
list(REMOVE_ITEM OS_SOURCE ./src/os/unix/ngx_aio_write_chain.c)


list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_dav_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_degradation_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_geoip_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_image_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_realip_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_ssl_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_stub_status_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_addition_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_charset_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_chunked_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_flv_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_gzip_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_mp4_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_random_index_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_secure_link_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_ssl_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_sub_filter_module.c)
list(REMOVE_ITEM HTTP_MODULES_SOURCE ./src/http/modules/ngx_http_xslt_filter_module.c)

include_directories(./src/core)
include_directories(./src/event)
include_directories(./src/event/modules)
include_directories(./src/http)
include_directories(./src/http/modules)
include_directories(./src/http/modules/perl)
include_directories(./src/mail)
include_directories(./src/misc)
include_directories(./src/os/unix)
include_directories(./src/stream)
include_directories(./objs)
include_directories(${INC_DIR})

link_directories(${LINK_DIR})

find_package( OpenSSL )
include_directories(${OPENSSL_INCLUDE_DIR})

find_package( Threads )

add_executable(nginx_1 ${CORE_SOURCE} ${EVENT_SOURCE} ${OS_SOURCE} ${MODULES_SOURCE} ${HTTP_SOURCE} ${HTTP_MODULES_SOURCE}   ${OS_SOURCE}  ${STREAM_SOURCE})

target_link_libraries (nginx_1 /usr/lib64/libpthread.so /lib64/libpcre.so /usr/lib64/libssl.so /usr/lib64/libcrypto.so /usr/lib64/libcrypt.so)

